from matplotlib import pyplot
import statistics
# EMNIST, balanced

TOT_NOISE = 0.411
MIU_NOISE = [0.029521275846723545, 0.2312233983439968, 0.39707445844690853, 0.38127658627134686]
STD_NOISE = [0.018709274756350206, 0.04309041687002444, 0.04498906140328897, 0.046520283515651344]
CNN_NOISE = [0.39308509722034984, 0.24111701492616472, 0.24382978083288415, 0.3099999927935448, 0.3283510558465694, 0.4894148808844546, 0.3766489269885611, 0.20824467446258726, 0.2126063769485088, 0.35393616152887647]

TOT_BLUR = 0.689
MIU_BLUR = [0.15563829811884367, 0.4480851037388152, 0.6647340431809425, 0.6520744679456062]
STD_BLUR = [0.0390682530346692, 0.04982915168657338, 0.04919060064523528, 0.0492885728229028]
CNN_BLUR = [0.6202127668768802, 0.6744680867550221, 0.7410638313344184, 0.655797873722746, 0.699468086057521, 0.7062234060561403, 0.6592021305510338, 0.6890425558419938, 0.6848404261660068, 0.6493617039411625]

TOT_TRANS = 0.853
MIU_TRANS = [0.5646276462902414, 0.7502127479999623, 0.7581382802826293, 0.7923935975166078]
STD_TRANS = [0.050201408533735045, 0.042299634406440516, 0.04766462365641103, 0.042679180094108864]
CNN_TRANS = [0.26228722735763865, 0.4339893493563571, 0.3820744578508621, 0.33212765219046714, 0.2682978651149476, 0.4215957340090833, 0.37196807705975593, 0.2614893542325243, 0.38622339371036973, 0.31563829083709005]

TOT_ROT = 0.596
MIU_ROT = [0.3034574480608423, 0.3511170224147908, 0.5578723372297084, 0.590797870875673]
STD_ROT = [0.05005091935972197, 0.04783356872933732, 0.047670267178763104, 0.04590040166737066]
CNN_ROT = [0.26031914218626123, 0.29324467345438104, 0.2726063760829733, 0.2996276519558531, 0.2499999936194496, 0.2900531824598921, 0.23893616344541946, 0.257021270296041, 0.2624999927554993, 0.3051595672806527]

TOT_MAG = 0.696
MIU_MAG = [0.1557978729103157, 0.460797869620171, 0.5838297852810393, 0.6605851073214348]
STD_MAG = [0.033843009868595876, 0.05439901612627148, 0.05312897181556344, 0.047540337537934914]
CNN_MAG = [0.4707978589737669, 0.5081914764769534, 0.5227659442957412, 0.5134042425358549, 0.5226595612599495, 0.544042539881899, 0.49452126374904143, 0.5168616892175472, 0.4955850936313893, 0.5363829654264958]

TOT_QUA = statistics.mean([0.9953999811410904, 0.9956999826431274, 0.9958999842405319])
MIU_QUA = [0.21349999323487281, 0.9886999690532684, 0.9953999823331833, 0.9954999828338623]
STD_QUA = [0.038986528525578656, 0.010116004465694642, 0.006730021683632941, 0.0067232641460236026]
CNN_QUA = [0.9954000043869019, 0.9951000046730042, 0.9947000050544739]

pyplot.rcParams["font.family"] = "serif"

fig, axes = pyplot.subplots(ncols=5, sharey=True)
fig.set_size_inches(16, 4)

def plot(i, tot, miu, std, cnn, title):
    x = list(range(1, len(miu)+1))
    axes[i].set_xticks(x)
    axes[i].set_title(title)
    axes[i].plot(x, [tot] * len(miu), "b-", label="Overall consensus")
    low = statistics.mean(cnn)
    axes[i].errorbar(x, miu, yerr=std, fmt="gx--", label="Individual layer")
    axes[i].plot(x, [low] * len(miu), "r-", label="Base CNN")

plot(2, TOT_NOISE, MIU_NOISE, STD_NOISE, CNN_NOISE, "Noise (30 std)")
plot(3, TOT_BLUR, MIU_BLUR, STD_BLUR, CNN_BLUR, "Blur (1.2 std)")
plot(0, TOT_TRANS, MIU_TRANS, STD_TRANS, CNN_TRANS, "Translation (20 pixels)")
#plot(3, TOT_ROT, MIU_ROT, STD_ROT, CNN_ROT, "Rotation (45 degrees)")
plot(1, TOT_MAG, MIU_MAG, STD_MAG, CNN_MAG, "Magnification (1.5)")
plot(4, TOT_QUA, MIU_QUA, STD_QUA, CNN_QUA, "MNIST quadrants")

axes[0].legend(prop={'size': 9})

axes[0].set_ylabel("Accuracy")
axes[2].set_xlabel("Layer")

pyplot.savefig("layereval.png", bbox_inches="tight")
